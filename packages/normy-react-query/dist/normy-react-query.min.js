!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@normy/core"),require("react")):"function"==typeof define&&define.amd?define(["@normy/core","react"],t):"object"==typeof exports?exports.NormyReactQuery=t(require("@normy/core"),require("react")):e.NormyReactQuery=t(e.Normy,e.React)}(self,((e,t)=>(()=>{"use strict";var r={700:t=>{t.exports=e},359:e=>{e.exports=t}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,o),a.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{o.r(a),o.d(a,{QueryNormalizerProvider:()=>l,createQueryNormalizer:()=>u,getId:()=>e.getId,useQueryNormalizer:()=>y});var e=o(700),t=function(e){return Array.isArray(e)?e.map((function(e){return"@@"+e})):"@@"+e},r=function(e,t){return void 0===t?e:t},n=function(e,t,r){t.getQueriesToUpdate(e).forEach((function(e){r.setQueryData(JSON.parse(e.queryKey),(function(){return e.data}))}))},u=function(o,a){var u;void 0===a&&(a={});var i=null==(u=a.normalize)||u,c=(0,e.createNormalizer)(a),l=null,y=null;return{getNormalizedData:c.getNormalizedData,setNormalizedData:function(e){return n(e,c,o)},clear:c.clearNormalizedData,subscribe:function(){l=o.getQueryCache().subscribe((function(e){var t;"removed"===e.type?c.removeQuery(JSON.stringify(e.query.queryKey)):"updated"===e.type&&"success"===e.action.type&&void 0!==e.action.data&&r(i,null==(t=e.query.meta)?void 0:t.normalize)&&c.setQuery(JSON.stringify(e.query.queryKey),e.action.data)})),y=o.getMutationCache().subscribe((function(e){var t,a,u;"updated"===e.type&&"success"===e.action.type&&e.action.data&&r(i,null==(t=e.mutation.meta)?void 0:t.normalize)?n(e.action.data,c,o):"updated"===e.type&&"pending"===e.action.type&&null!=(a=e.mutation.state)&&null!=(a=a.context)&&a.optimisticData?n(e.mutation.state.context.optimisticData,c,o):"updated"===e.type&&"error"===e.action.type&&null!=(u=e.mutation.state)&&null!=(u=u.context)&&u.rollbackData&&n(e.mutation.state.context.rollbackData,c,o)}))},unsubscribe:function(){null==l||l(),null==y||y(),l=null,y=null},getObjectById:c.getObjectById,getQueryFragment:c.getQueryFragment,getQueryKeysById:function(e){return c.getQueriesById(t(e)).map((function(e){return JSON.parse(e)}))},invalidateQueriesById:function(e){c.getQueriesById(t(e)).map((function(e){return JSON.parse(e)})).forEach((function(e){return o.invalidateQueries({queryKey:e})}))}}},i=o(359),c=i.createContext(void 0),l=function(e){var t=e.queryClient,r=e.normalizerConfig,n=e.children,o=i.useState((function(){return u(t,r)}))[0];return i.useEffect((function(){return o.subscribe(),function(){o.unsubscribe(),o.clear()}}),[]),i.createElement(c.Provider,{value:o},n)},y=function(){var e=i.useContext(c);if(!e)throw new Error("No QueryNormalizer set, use QueryNormalizerProvider to set one");return e}})(),a})()));
//# sourceMappingURL=normy-react-query.min.js.map